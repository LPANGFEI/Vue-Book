{"remainingRequest":"C:\\Users\\LPANGFEI\\Desktop\\Vue\\vue-book\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\LPANGFEI\\Desktop\\Vue\\vue-book\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\LPANGFEI\\Desktop\\Vue\\vue-book\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\LPANGFEI\\Desktop\\Vue\\vue-book\\src\\views\\Ranking.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\LPANGFEI\\Desktop\\Vue\\vue-book\\src\\views\\Ranking.vue","mtime":1567757417212},{"path":"C:\\Users\\LPANGFEI\\Desktop\\Vue\\vue-book\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\LPANGFEI\\Desktop\\Vue\\vue-book\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\LPANGFEI\\Desktop\\Vue\\vue-book\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\LPANGFEI\\Desktop\\Vue\\vue-book\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\LPANGFEI\\Desktop\\Vue\\vue-book\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\LPANGFEI\\Desktop\\Vue\\vue-book\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\LPANGFEI\\Desktop\\Vue\\vue-book\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\LPANGFEI\\Desktop\\Vue\\vue-book\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.replace\";\nimport \"core-js/modules/es7.symbol.async-iterator\";\nimport \"core-js/modules/es6.symbol\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\LPANGFEI\\\\Desktop\\\\Vue\\\\vue-book\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/asyncToGenerator\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { setTimeout } from \"timers\";\nimport BScroll from \"better-scroll\";\nimport BookDetails from \"../components/BookDetails\";\nexport default {\n  name: \"Ranking\",\n  data: function data() {\n    return {\n      isLoading: true,\n      rankings: {},\n      menuBScroll: null,\n      listBScroll: null,\n      menus: [],\n      lists: [],\n      books: [],\n      booksHeight: [0],\n      currentIndex: 0,\n      activeIndex: null\n    };\n  },\n  components: {\n    BookDetails: BookDetails\n  },\n  filters: {\n    toUpperCase: function toUpperCase(value) {\n      return value.toUpperCase();\n    }\n  },\n  methods: {\n    getRankingMenu: function () {\n      var _getRankingMenu = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee() {\n        var _this = this;\n\n        var res, index, i, _iteratorNormalCompletion, _didIteratorError, _iteratorError, _iterator, _step, _i;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this.$http(\"/ranking/gender\");\n\n              case 2:\n                res = _context.sent;\n                res = res.data;\n                this.$delete(res, \"ok\");\n                this.rankings = res;\n                index = this.$route.query.index;\n\n                if (!(index === undefined)) {\n                  _context.next = 15;\n                  break;\n                }\n\n                _context.t0 = regeneratorRuntime.keys(res);\n\n              case 9:\n                if ((_context.t1 = _context.t0()).done) {\n                  _context.next = 15;\n                  break;\n                }\n\n                i = _context.t1.value;\n                index = i;\n                return _context.abrupt(\"break\", 15);\n\n              case 15:\n                this.activeIndex = index;\n                this.menus = res[index];\n                _iteratorNormalCompletion = true;\n                _didIteratorError = false;\n                _iteratorError = undefined;\n                _context.prev = 20;\n\n                for (_iterator = this.menus[Symbol.iterator](); !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n                  _i = _step.value;\n                  this.getRankingList(_i._id);\n                } // 加载动画\n\n\n                _context.next = 28;\n                break;\n\n              case 24:\n                _context.prev = 24;\n                _context.t2 = _context[\"catch\"](20);\n                _didIteratorError = true;\n                _iteratorError = _context.t2;\n\n              case 28:\n                _context.prev = 28;\n                _context.prev = 29;\n\n                if (!_iteratorNormalCompletion && _iterator.return != null) {\n                  _iterator.return();\n                }\n\n              case 31:\n                _context.prev = 31;\n\n                if (!_didIteratorError) {\n                  _context.next = 34;\n                  break;\n                }\n\n                throw _iteratorError;\n\n              case 34:\n                return _context.finish(31);\n\n              case 35:\n                return _context.finish(28);\n\n              case 36:\n                this.$nextTick(function () {\n                  _this.initLoading();\n                });\n\n              case 37:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[20, 24, 28, 36], [29,, 31, 35]]);\n      }));\n\n      function getRankingMenu() {\n        return _getRankingMenu.apply(this, arguments);\n      }\n\n      return getRankingMenu;\n    }(),\n    // 列表\n    getRankingList: function () {\n      var _getRankingList = _asyncToGenerator(\n      /*#__PURE__*/\n      regeneratorRuntime.mark(function _callee2(id) {\n        var _this2 = this;\n\n        var res;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return this.$http(\"/ranking/\".concat(id));\n\n              case 2:\n                res = _context2.sent;\n                res = res.data.ranking;\n                this.lists = res;\n                this.books.push(this.lists);\n                this.$nextTick(function () {\n                  _this2.calculationHeight();\n                });\n\n              case 7:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function getRankingList(_x) {\n        return _getRankingList.apply(this, arguments);\n      }\n\n      return getRankingList;\n    }(),\n    initLoading: function initLoading() {\n      var _this3 = this;\n\n      setTimeout(function () {\n        _this3.isLoading = false;\n      }, 1000);\n    },\n    initBScroll: function initBScroll() {\n      if (this.menuBScroll) {\n        this.menuBScroll.refresh();\n      } else {\n        this.menuBScroll = new BScroll(this.$refs.menu, {\n          probeType: 3,\n          click: true\n        });\n      }\n\n      if (this.listBScroll) {\n        this.listBScroll.refresh();\n      } else {\n        this.listBScroll = new BScroll(this.$refs.list, {\n          probeType: 2,\n          click: true\n        });\n        this.listBScroll.on(\"scroll\", this.booksWrapperScroll);\n      }\n    },\n    // 跳转排行榜\n    goToRanking: function goToRanking(index) {\n      var title = this.$route.query.index;\n\n      if (title !== index) {\n        this.$router.replace({\n          path: \"/ranking\",\n          query: {\n            index: index\n          }\n        });\n      }\n    },\n    // 跳转详情页\n    goToDetail: function goToDetail(item) {\n      this.$router.push({\n        path: \"/bookdetail\",\n        query: {\n          title: item.title,\n          id: item._id\n        }\n      });\n    },\n    // 计算列表高度\n    calculationHeight: function calculationHeight() {\n      var height = 0;\n      var books = this.$refs.bookList;\n      books.forEach(function (item) {\n        height += item.clientHeight;\n      });\n      this.booksHeight.push(height);\n    },\n    // 点击菜单滑动列表\n    scrollToCurrentBook: function scrollToCurrentBook(index) {\n      this.currentIndex = index;\n      var offsetY = -this.booksHeight[index];\n      this.listBScroll.scrollTo(0, offsetY, 300);\n    },\n    // 滑动列表切换菜单\n    booksWrapperScroll: function booksWrapperScroll(_ref) {\n      var y = _ref.y;\n      // 页面滑动后触发的滑动偏移量,与菜单栏哪一个应该高亮的对应函数\n      var num = parseInt(y);\n\n      if (num > 0) {\n        this.currentIndex = 0;\n      } else {\n        num = Math.abs(num); // 滑动页面向下滑动偏移量是负数\n\n        for (var i = 0; i < this.booksHeight.length - 1; i++) {\n          var h1 = this.booksHeight[i];\n          var h2 = this.booksHeight[i + 1];\n\n          if (num >= h1 && num < h2) {\n            this.currentIndex = i;\n            break;\n          }\n        }\n      }\n    }\n  },\n  created: function created() {\n    this.getRankingMenu();\n  },\n  mounted: function mounted() {\n    this.initBScroll();\n  },\n  beforeDestroy: function beforeDestroy() {\n    this.menuBScroll.destroy();\n    this.listBScroll.destroy();\n    this.menuBScroll = null;\n    this.listBScroll = null;\n  }\n};",{"version":3,"sources":["Ranking.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n    <section class=\"ranking\">\r\n        <!-- loading -->\r\n        <Spin v-show=\"isLoading\" />\r\n        <!-- 顶部栏 -->\r\n        <BookHeader title=\"排行榜\" />\r\n        <!-- 导航 -->\r\n        <nav class=\"nav\">\r\n            <span\r\n                v-for=\"(ranking, index) in rankings\"\r\n                :key=\"index\"\r\n                :class=\"['tab',{active:activeIndex===index}]\"\r\n                @click=\"goToRanking(index)\"\r\n            >{{index | toUpperCase}}</span>\r\n        </nav>\r\n        <!-- 内容 -->\r\n        <div class=\"container\">\r\n            <!-- 侧边栏 -->\r\n            <div class=\"book-menu\" ref=\"menu\">\r\n                <div>\r\n                    <div\r\n                        :class=\"['menu',{active:currentIndex===index}]\"\r\n                        v-for=\"(menu,index) in menus\"\r\n                        :key=\"index\"\r\n                        @click=\"scrollToCurrentBook(index)\"\r\n                    >{{menu.shortTitle}}</div>\r\n                    <div class=\"blank\"></div>\r\n                </div>\r\n            </div>\r\n            <!-- 排行列表 -->\r\n            <div class=\"book-list\" ref=\"list\">\r\n                <div>\r\n                    <div class=\"list\" v-for=\"(book,index) in books\" :key=\"index\" ref=\"bookList\">\r\n                        <!-- 榜单名 -->\r\n                        <div class=\"title\">\r\n                            <img v-lazy=\"`//statics.zhuishushenqi.com${book.cover}`\" />\r\n                            <span>{{book.title}}</span>\r\n                        </div>\r\n                        <!-- 内容 -->\r\n                        <BookDetails\r\n                            v-for=\"data in book.books\"\r\n                            :key=\"data._id\"\r\n                            :datas=\"data\"\r\n                            @jump=\"goToDetail\"\r\n                        />\r\n                        <div class=\"none\" v-show=\"!book.books.length\">\r\n                            <p>空</p>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"blank\"></div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </section>\r\n</template>\r\n\r\n<script>\r\nimport { setTimeout } from \"timers\";\r\nimport BScroll from \"better-scroll\";\r\nimport BookDetails from \"../components/BookDetails\";\r\nexport default {\r\n    name: \"Ranking\",\r\n    data: () => ({\r\n        isLoading: true,\r\n        rankings: {},\r\n        menuBScroll: null,\r\n        listBScroll: null,\r\n        menus: [],\r\n        lists: [],\r\n        books: [],\r\n        booksHeight: [0],\r\n        currentIndex: 0,\r\n        activeIndex: null\r\n    }),\r\n    components: {\r\n        BookDetails\r\n    },\r\n    filters: {\r\n        toUpperCase(value) {\r\n            return value.toUpperCase();\r\n        }\r\n    },\r\n    methods: {\r\n        async getRankingMenu() {\r\n            let res = await this.$http(\"/ranking/gender\");\r\n            res = res.data;\r\n            this.$delete(res, \"ok\");\r\n            this.rankings = res;\r\n            let { index } = this.$route.query;\r\n            if (index === undefined) {\r\n                for (let i in res) {\r\n                    index = i;\r\n                    break;\r\n                }\r\n            }\r\n            this.activeIndex = index;\r\n            this.menus = res[index];\r\n            for (let i of this.menus) {\r\n                this.getRankingList(i._id);\r\n            }\r\n            // 加载动画\r\n            this.$nextTick(() => {\r\n                this.initLoading();\r\n            });\r\n        },\r\n        // 列表\r\n        async getRankingList(id) {\r\n            let res = await this.$http(`/ranking/${id}`);\r\n            res = res.data.ranking;\r\n            this.lists = res;\r\n            this.books.push(this.lists);\r\n            this.$nextTick(() => {\r\n                this.calculationHeight();\r\n            });\r\n        },\r\n        initLoading() {\r\n            setTimeout(() => {\r\n                this.isLoading = false;\r\n            }, 1000);\r\n        },\r\n        initBScroll() {\r\n            if (this.menuBScroll) {\r\n                this.menuBScroll.refresh();\r\n            } else {\r\n                this.menuBScroll = new BScroll(this.$refs.menu, {\r\n                    probeType: 3,\r\n                    click: true\r\n                });\r\n            }\r\n            if (this.listBScroll) {\r\n                this.listBScroll.refresh();\r\n            } else {\r\n                this.listBScroll = new BScroll(this.$refs.list, {\r\n                    probeType: 2,\r\n                    click: true\r\n                });\r\n                this.listBScroll.on(\"scroll\", this.booksWrapperScroll);\r\n            }\r\n        },\r\n        // 跳转排行榜\r\n        goToRanking(index) {\r\n            let title = this.$route.query.index;\r\n            if (title !== index) {\r\n                this.$router.replace({\r\n                    path: \"/ranking\",\r\n                    query: {\r\n                        index\r\n                    }\r\n                });\r\n            }\r\n        },\r\n        // 跳转详情页\r\n        goToDetail(item) {\r\n            this.$router.push({\r\n                path: \"/bookdetail\",\r\n                query: {\r\n                    title: item.title,\r\n                    id: item._id\r\n                }\r\n            });\r\n        },\r\n        // 计算列表高度\r\n        calculationHeight() {\r\n            let height = 0;\r\n            let books = this.$refs.bookList;\r\n            books.forEach(item => {\r\n                height += item.clientHeight;\r\n            });\r\n            this.booksHeight.push(height);\r\n        },\r\n        // 点击菜单滑动列表\r\n        scrollToCurrentBook(index) {\r\n            this.currentIndex = index;\r\n            let offsetY = -this.booksHeight[index];\r\n            this.listBScroll.scrollTo(0, offsetY, 300);\r\n        },\r\n        // 滑动列表切换菜单\r\n        booksWrapperScroll({ y }) {\r\n            // 页面滑动后触发的滑动偏移量,与菜单栏哪一个应该高亮的对应函数\r\n            let num = parseInt(y);\r\n            if (num > 0) {\r\n                this.currentIndex = 0;\r\n            } else {\r\n                num = Math.abs(num); // 滑动页面向下滑动偏移量是负数\r\n                for (var i = 0; i < this.booksHeight.length - 1; i++) {\r\n                    let h1 = this.booksHeight[i];\r\n                    let h2 = this.booksHeight[i + 1];\r\n                    if (num >= h1 && num < h2) {\r\n                        this.currentIndex = i;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    },\r\n    created() {\r\n        this.getRankingMenu();\r\n    },\r\n    mounted() {\r\n        this.initBScroll();\r\n    },\r\n    beforeDestroy() {\r\n        this.menuBScroll.destroy();\r\n        this.listBScroll.destroy();\r\n        this.menuBScroll = null;\r\n        this.listBScroll = null;\r\n    }\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.ranking {\r\n    width: 100%;\r\n    overflow: hidden;\r\n    .nav {\r\n        display: flex;\r\n        justify-content: center;\r\n        align-items: center;\r\n        height: 40px;\r\n        border-bottom: 1px solid #eee;\r\n        .tab {\r\n            display: inline-block;\r\n            flex: 1;\r\n            text-align: center;\r\n            font-size: 14px;\r\n            line-height: 40px;\r\n            color: #8a8a8f;\r\n            &.active {\r\n                border-bottom: 1px solid #b83320;\r\n                font-weight: bold;\r\n                color: #b83320;\r\n            }\r\n        }\r\n    }\r\n    .container {\r\n        display: flex;\r\n        width: 100%;\r\n        height: 100vh;\r\n        .blank {\r\n            height: 80px !important;\r\n        }\r\n    }\r\n}\r\n.book-menu {\r\n    flex: 0 0 80px;\r\n    width: 80px;\r\n    height: 100vh;\r\n    padding: 0 10px;\r\n    overflow: hidden;\r\n    .menu {\r\n        width: 100%;\r\n        height: 50px;\r\n        border-bottom: 1px solid #eee;\r\n        font-size: 13px;\r\n        text-align: center;\r\n        line-height: 50px;\r\n        color: #8a8a8f;\r\n        &.active {\r\n            font-weight: bold;\r\n            color: #b83320;\r\n        }\r\n    }\r\n}\r\n.book-list {\r\n    flex: 1;\r\n    width: 100%;\r\n    height: 100vh;\r\n    overflow: hidden;\r\n    .list {\r\n        width: 100%;\r\n        padding: 10px;\r\n        border-bottom: 1px solid #eee;\r\n        .title {\r\n            display: flex;\r\n            // justify-content: center;\r\n            // align-items: center;\r\n            width: 100%;\r\n            img {\r\n                display: block;\r\n                width: 20px;\r\n                height: 20px;\r\n            }\r\n            span {\r\n                flex: 1;\r\n                width: 100%;\r\n                height: 20px;\r\n                padding-left: 10px;\r\n                font-size: 14px;\r\n                line-height: 20px;\r\n            }\r\n        }\r\n        .none {\r\n            width: 100%;\r\n            height: 20px;\r\n            p {\r\n                margin: 10px 0;\r\n                font-size: 14px;\r\n                line-height: 20px;\r\n                text-align: center;\r\n                color: #ccc;\r\n            }\r\n        }\r\n    }\r\n}\r\n</style>\r\n"],"sourceRoot":"src/views"}]}